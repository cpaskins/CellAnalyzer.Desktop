<Window x:Class="CellAnalyzer.Desktop.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Cell Analyzer" Height="700" Width="1000"
        WindowState="Maximized"
        Background="{DynamicResource BgBrush}">

    <Grid Margin="10" Background="{DynamicResource BgBrush}">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Buttons -->
        <Border Grid.Row="0" Background="#FF0D1016" CornerRadius="12" Padding="12" Margin="0,0,0,10">
            <StackPanel Orientation="Horizontal">
                <Button Content="Load Image"
                Width="120"
                Margin="0,0,10,0"
                Click="LoadImage_Click"
                Style="{StaticResource SecondaryButtonStyle}"/>
                <Button Content="Analyze"
                Width="120"
                Click="Analyze_Click"/>
                
            </StackPanel>
        </Border>

        <!-- Parameters + Images -->
        <Grid Grid.Row="1" Margin="24,12,24,12">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="260"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- PARAMETERS PANEL -->
            <ScrollViewer Grid.Column="0" VerticalScrollBarVisibility="Auto">
                <StackPanel Margin="0,0,16,0">

                    <Border Height="1"
                            Background="{DynamicResource BorderBrushTheme}"
                            Margin="0,0,0,12"/>

                    <TextBlock Text="Parameters"
                               FontWeight="SemiBold"
                               FontSize="14"
                               Margin="0,0,0,12"/>
                    <!-- Preset actions -->
                    <Grid Margin="0,0,0,16">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <Button Content="Load Preset"
                                Grid.Column="0"
                                Margin="0,0,6,0"
                                Click="LoadPreset_Click"
                                Style="{StaticResource SecondaryButtonStyle}"/>

                        <Button Content="Save Preset"
                                Grid.Column="1"
                                Margin="6,0,0,0"
                                Click="SavePreset_Click"
                                Style="{StaticResource SecondaryButtonStyle}"/>
                    </Grid>
                    
                    <Border Height="1"
                            Background="{DynamicResource BorderBrushTheme}"
                            Margin="0,0,0,12"/>

                    <TextBlock Text="Minimum Area"/>
                    <TextBox x:Name="MinimumAreaBox" Margin="0,0,0,8"/>

                    <TextBlock Text="Average Cell Area"/>
                    <TextBox x:Name="AverageAreaBox" Margin="0,0,0,8"/>

                    <TextBlock Text="Connected Cell Area"/>
                    <TextBox x:Name="ConnectedAreaBox" Margin="0,0,0,12"/>

                    <TextBlock Text="Lower Intensity"/>
                    <TextBox x:Name="LowerIntensityBox" Margin="0,0,0,8"/>

                    <TextBlock Text="Upper Intensity"/>
                    <TextBox x:Name="UpperIntensityBox" Margin="0,0,0,12"/>

                    <TextBlock Text="Scaling"/>
                    <TextBox x:Name="ScalingBox" Margin="0,0,0,12"/>

                    <CheckBox x:Name="MorphBox" Content="Apply Morphology" Margin="0,0,0,8"/>
                    <CheckBox x:Name="NoiseBox" Content="Median Filter" Margin="0,0,0,8"/>
                    <CheckBox x:Name="OpeningBox" Content="Open Transform" Margin="0,0,0,8"/>
                    <CheckBox x:Name="ClosingBox" Content="Close Transform" Margin="0,0,0,12"/>

                    <TextBlock Text="Kernel Size (odd number)" Margin="0,8,0,0"/>
                    <TextBox x:Name="KernelSizeBox" Margin="0,0,0,8"/>

                    <CheckBox x:Name="ErodingBox" Content="Erode" Margin="0,0,0,8"/>
                    <CheckBox x:Name="DilatingBox" Content="Dilate" Margin="0,0,0,12"/>

                    <TextBlock Text="Open Iterations"/>
                    <TextBox x:Name="OpenIterBox" Margin="0,0,0,8"/>

                    <TextBlock Text="Close Iterations"/>
                    <TextBox x:Name="CloseIterBox" Margin="0,0,0,8"/>

                    <TextBlock Text="Erode Iterations"/>
                    <TextBox x:Name="ErodeIterBox" Margin="0,0,0,8"/>

                    <TextBlock Text="Dilate Iterations"/>
                    <TextBox x:Name="DilateIterBox" Margin="0,0,0,12"/>

                    <TextBlock Text="Hole Size"/>
                    <TextBox x:Name="HoleSizeBox" Margin="0,0,0,8"/>

                    <TextBlock Text="Hole Threshold"/>
                    <TextBox x:Name="HoleThresholdBox" Margin="0,0,0,12"/>

                    <TextBlock Text="Image Method"/>
                    <ComboBox x:Name="ImageMethodBox" Margin="0,0,0,12">
                        <ComboBoxItem Content="Sobel"/>
                        <ComboBoxItem Content="Canny"/>
                        <ComboBoxItem Content="Laplace"/>
                        <ComboBoxItem Content="Prewitt"/>
                        <ComboBoxItem Content="Roberts Cross"/>
                        <ComboBoxItem Content="Scharr"/>
                        <ComboBoxItem Content="Frei Chen"/>
                        <ComboBoxItem Content="Block Segmentation"/>
                        <ComboBoxItem Content="Histogram"/>
                        <ComboBoxItem Content="Double"/>
                        <ComboBoxItem Content="None"/>
                    </ComboBox>

                    <TextBlock Text="Contour Method"/>
                    <ComboBox x:Name="ContourMethodBox">
                        <ComboBoxItem Content="OpenCV"/>
                        <ComboBoxItem Content="SciKit"/>
                        <ComboBoxItem Content="Basic"/>
                        <ComboBoxItem Content="Blobber"/>
                    </ComboBox>


                </StackPanel>
            </ScrollViewer>

            <!-- IMAGES GRID -->
            <Grid Grid.Column="1">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <!-- Original -->
                <Border Background="{DynamicResource PanelBrush}"
                        Grid.Column="0"
                        BorderBrush="{DynamicResource BorderBrushTheme}"
                        BorderThickness="1"
                        CornerRadius="10"
                        Padding="10">

                    <Viewbox Stretch="Uniform">
                        <Image x:Name="OriginalImage"
                               Stretch="Uniform"
                               StretchDirection="DownOnly"
                               SnapsToDevicePixels="True"
                               RenderOptions.BitmapScalingMode="HighQuality"/>
                    </Viewbox>
                </Border>

                <!-- Overlay -->
                <Border Background="{DynamicResource PanelBrush}"
                        Grid.Column="1"
                        BorderBrush="{DynamicResource BorderBrushTheme}"
                        BorderThickness="1"
                        CornerRadius="10"
                        Padding="10">

                    <Viewbox Stretch="Uniform">
                        <Image x:Name="OverlayImage"
                               Stretch="Uniform"
                               StretchDirection="DownOnly"
                               SnapsToDevicePixels="True"
                               RenderOptions.BitmapScalingMode="HighQuality"/>
                    </Viewbox>
                </Border>
            </Grid>
        </Grid>

        <!-- Metrics -->
        <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Left" Margin="0,10,0,10">
            <TextBlock x:Name="CellCountText" Text="Cells: -" Margin="0,0,20,0" FontWeight="Bold"/>
            <TextBlock x:Name="TotalAreaText" Text="Total Contour Area: -" Margin="0,0,20,0" FontWeight="Bold"/>
            <TextBlock x:Name="MeanAreaText" Text="Mean Contour Area: -" FontWeight="Bold"/>
        </StackPanel>

        <!-- Status -->
        <TextBlock x:Name="StatusText" Grid.Row="3" Text="Status: Idle" FontWeight="Bold"/>
    </Grid>
</Window>
